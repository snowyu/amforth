# -----------------------------------------------------------------------------
#  Multiplication, Division and Remainder available as opcodes in RV32IM
#  Rewrite these to get a pure RV32I Forth.
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "*", STAR # ( x1 x2 -- x1*x2 )
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  addi x4, x4, 4
  mul x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "um*", UMSTAR # ( u1 u2 -- ud )
um_star:
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  mul x6, x5, x3
  sw x6, 0(x4)
  mulhu x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "m*", MSTAR # ( n1 n2 -- d )
m_star:
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  mul x6, x5, x3
  sw x6, 0(x4)
  mulh x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "/", SLASH # ( n1 n2 -- n1/n2 )
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  addi x4, x4, 4
  div x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "mod", MOD # ( n1 n2 -- n1%n2 )
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  addi x4, x4, 4
  rem x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "u/mod", U_SLASH_MOD # ( u1 u2 -- rem quot )
u_divmod:
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  remu x6, x5, x3
  sw x6, 0(x4)
  divu x3, x5, x3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD Flag_foldable_2, "/mod", SLASHMOD # ( n1 n2 -- rem quot )
divmod:
# -----------------------------------------------------------------------------
  lw x5, 0(x4)
  rem x6, x5, x3
  sw x6, 0(x4)
  div x3, x5, x3
  NEXT
 
